---
layout: post
title: "DISTINCT and ORDER BY together"
---

<div dir="ltr" style="text-align: left;" trbidi="on">When we are using DISTINCT we canâ€™t use ORDER BY as we want. If you are going to use DISTINCT when you have ORDER BY, all ORDER BY attributes should be in the SELECT phrase.<br /><span style="font-family: Courier New;"><span style="color: blue;">USE </span><span style="color: teal;">AdventureWorks2012</span></span><span style="color: grey;"><span style="font-family: Courier New;">;<br /></span></span><span style="font-family: Courier New;"><span style="color: green;">-- Works fine</span><span style="color: blue;">SELECT </span></span><span style="font-family: Courier New;"><span style="color: teal;">BusinessEntityID</span><span style="color: blue;">FROM </span><span style="color: teal;">HumanResources</span><span style="color: grey;">.</span></span><span style="font-family: Courier New;"><span style="color: teal;">Employee</span><span style="color: blue;">ORDER BY </span><span style="color: teal;">BirthDate</span></span><span style="color: grey;"><span style="font-family: Courier New;">;<br /></span></span><span style="font-family: Courier New;"><span style="color: green;">-- Fails</span><span style="color: blue;">SELECT DISTINCT</span></span><span style="font-family: Courier New;"><span style="color: teal;">BusinessEntityID</span><span style="color: blue;">FROM </span><span style="color: teal;">HumanResources</span><span style="color: grey;">.</span></span><span style="font-family: Courier New;"><span style="color: teal;">Employee</span><span style="color: blue;">ORDER BY </span><span style="color: teal;">BirthDate</span></span><span style="font-family: Courier New;"><span style="color: grey;">;<br /></span><span style="color: green;">-- If you are going to sort with distinct</span></span><span style="font-family: Courier New;"><span style="color: green;">&nbsp;result should consist attribute that you are sorting</span><span style="color: blue;">SELECT DISTINCT </span></span><span style="font-family: Courier New;"><span style="color: teal;">BusinessEntityID</span><span style="color: blue;">FROM </span><span style="color: teal;">HumanResources</span><span style="color: grey;">.</span></span><span style="font-family: Courier New;"><span style="color: teal;">Employee</span><span style="color: blue;">ORDER BY </span><span style="color: teal;">BusinessEntityID</span></span><span style="color: grey;"><span style="font-family: Courier New;">;</span><br /></span><span style="color: grey;"></span><br />Otherwise, it fails with the following error. <br /><span style="color: red; font-family: Courier New;">ORDER BY items must appear in the select list if SELECT DISTINCT is specified.</span></div>

### Tags

- SQL
- SQL Server 2012
- TSQL
- SQL Server
- SQL Sever
